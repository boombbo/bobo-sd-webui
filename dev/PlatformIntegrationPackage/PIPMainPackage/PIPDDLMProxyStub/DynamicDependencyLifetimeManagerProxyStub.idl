// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See LICENSE in the project root for license information.

import "oaidl.idl";
import "ocidl.idl";

// TODO: #include "IDynamicDependencyLifetimeManager.idl"
[object]
[helpstring("IDynamicDependencyLifetimeManager must be implemented by all instances of DynamicDependency's LifetimeManager")]
[uuid(06F1BAD0-DD14-11d0-AB8F-0000C0148FDB)]
[pointer_default(unique)]
interface IDynamicDependencyLifetimeManager : IUnknown
{
    HRESULT Initialize();

    HRESULT Shutdown();

    HRESULT GetPackageFullName([out, retval] LPWSTR* packageFullName);
};

[uuid(1BF712E5-41ED-46a5-8402-2D40725F691E)]
[version(1.0)]
library TestDynDepMainSide
{
    [uuid(32E7CF70-038C-429a-BD49-88850F1B4A11)]
    coclass MyLifetimeManager
    {
        [default] interface IDynamicDependencyLifetimeManager;
    };
};
