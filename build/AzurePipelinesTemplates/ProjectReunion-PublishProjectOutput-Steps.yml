parameters:
  buildOutputArtifactName: 'reunion_binaries'
  fatNugetArtifactName: 'FatNuget'

steps:
  - task: powershell@2
    displayName: 'Copy files to staging dir'
    inputs:
      targetType: filePath
      filePath: build\CopyFilesToStagingDir.ps1
      arguments: -BuildOutputDir '$(buildOutputDir)' -BinaryDir '$(Build.ArtifactStagingDirectory)\${{ parameters.buildOutputArtifactName }}' -NugetDir '$(Build.ArtifactStagingDirectory)\${{ parameters.fatNugetArtifactName }}' -Platform '$(buildPlatform)' -Configuration '$(buildConfiguration)'

  - task: PublishBuildArtifacts@1
    displayName: 'Publish artifact: ${{ parameters.fatNugetArtifactName }}'
    inputs:
      PathtoPublish: '$(Build.ArtifactStagingDirectory)\${{ parameters.fatNugetArtifactName }}'
      artifactName: ${{ parameters.fatNugetArtifactName }}

  - task: PublishBuildArtifacts@1
    displayName: 'Publish artifact: ${{ parameters.buildOutputArtifactName }}'
    inputs:
      PathtoPublish: '$(Build.ArtifactStagingDirectory)\${{ parameters.buildOutputArtifactName }}'
      artifactName: ${{ parameters.buildOutputArtifactName }}
